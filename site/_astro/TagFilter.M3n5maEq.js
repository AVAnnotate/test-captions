import{j as e}from"./jsx-runtime.B6N9iRLn.js";import{u as U}from"./index.BDWyZ8Gq.js";import{r as l,R as w}from"./index.DNi1g-pO.js";import{c as S,t as X,a as q,b as J,$ as Q}from"./store.DMES6hWa.js";import{F as T}from"./XMarkIcon.2w2G2u9O.js";import{u as Y,a as Z,I as ee,G as te,$ as se,b as ae}from"./label.BDZJ2zrY.js";import{l as re,T as le,w as oe,j as ne,r as ie,o as z,p as ce,a as de,A as me,R as ge}from"./popover.KsDTL0Vr.js";import{p as ue}from"./use-server-handoff-complete.BXIqNzS3.js";import{W as xe,o as j,D as fe,H as he}from"./use-sync-refs.D0KZ01Xc.js";import"./index.iExtbhlT.js";function pe({title:s,titleId:r,...d},t){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},d),s?l.createElement("title",{id:r},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 13.5V3.75m0 9.75a1.5 1.5 0 0 1 0 3m0-3a1.5 1.5 0 0 0 0 3m0 3.75V16.5m12-3V3.75m0 9.75a1.5 1.5 0 0 1 0 3m0-3a1.5 1.5 0 0 0 0 3m0 3.75V16.5m-6-9V3.75m0 3.75a1.5 1.5 0 0 1 0 3m0-3a1.5 1.5 0 0 0 0 3m0 9.75V10.5"}))}const be=l.forwardRef(pe);function je({title:s,titleId:r,...d},t){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},d),s?l.createElement("title",{id:r},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const v=l.forwardRef(je);let we="span";function ye(s,r){let d=l.useId(),t=Y(),y=Z(),{id:m=t||`headlessui-checkbox-${d}`,disabled:o=y||!1,autoFocus:a=!1,checked:x,defaultChecked:n,onChange:g,name:i,value:u,form:k,indeterminate:b=!1,...L}=s,f=re(n),[h,p]=le(x,g,f??!1),D=ee(),V=te(),A=ue(),[N,$]=l.useState(!1),C=j(()=>{$(!0),p?.(!h),A.nextFrame(()=>{$(!1)})}),I=j(c=>{if(ie(c.currentTarget))return c.preventDefault();c.preventDefault(),C()}),M=j(c=>{c.key===z.Space?(c.preventDefault(),C()):c.key===z.Enter&&ce(c.currentTarget)}),O=j(c=>c.preventDefault()),{isFocusVisible:F,focusProps:G}=se({autoFocus:a}),{isHovered:E,hoverProps:B}=ae({isDisabled:o}),{pressed:R,pressProps:H}=oe({disabled:o}),K=fe({ref:r,id:m,role:"checkbox","aria-checked":b?"mixed":h?"true":"false","aria-labelledby":D,"aria-describedby":V,"aria-disabled":o?!0:void 0,indeterminate:b?"true":void 0,tabIndex:o?void 0:0,onKeyUp:o?void 0:M,onKeyPress:o?void 0:O,onClick:o?void 0:I},G,B,H),W=l.useMemo(()=>({checked:h,disabled:o,hover:E,focus:F,active:R,indeterminate:b,changing:N,autofocus:a}),[h,b,o,E,F,R,N,a]),_=l.useCallback(()=>{if(f!==void 0)return p?.(f)},[p,f]);return w.createElement(w.Fragment,null,i!=null&&w.createElement(ne,{disabled:o,data:{[i]:u||"on"},overrides:{type:"checkbox",checked:h},form:k,onReset:_}),he({ourProps:K,theirProps:L,slot:W,defaultTag:we,name:"Checkbox"}))}let P=xe(ye);const ke=s=>{const r=e.jsxs(e.Fragment,{children:[s.icon&&e.jsx(s.icon,{className:"size-4"}),e.jsx("span",{className:"font-semibold",children:s.tag}),s.count?e.jsx("span",{children:s.count}):null]});return s.onClick?e.jsx("button",{className:`rounded-full text-xs flex flex-row justify-center px-3 py-1.5 gap-1 cursor-default ${s.className||""}`,style:{backgroundColor:s.color},onClick:s.onClick,children:r}):e.jsx("div",{className:`rounded-full text-xs flex flex-row justify-center px-3 py-1.5 gap-1 cursor-default ${s.className||""}`,style:{backgroundColor:s.color},onClick:s.onClick,children:r})},Pe=s=>{const{playerId:r}=s,d=U(Q),t=l.useMemo(()=>d[r],[d,r]),y=s.projectData.data.project.tags.tagGroups,m=l.useMemo(()=>{const a={};return(t.sets.length>0?s.annotationSets.filter(n=>t.sets.includes(n.id)):s.annotationSets).forEach(n=>{n?.data.annotations.forEach(g=>{g.tags&&g.tags.length&&g.tags.forEach(i=>{const u=i.category.toLowerCase();a[u]||={tags:[],color:y.find(k=>k.category.toLowerCase()===u)?.color||"#FFF"},a[u].tags.includes(i.tag)||(a[u].tags.push(i.tag),a[u].tags.sort())})})}),a},[t.sets]),o=Object.keys(m);return e.jsxs(de,{children:[e.jsxs(me,{className:"bg-white rounded-lg flex flex-row justify-center items-center gap-2 px-2 py-1.5 data-[open]:bg-blue-hover font-semibold",children:[e.jsx(be,{className:"size-4"}),e.jsx("span",{children:"Filter"}),(t.tags.length>0||t.sets.length>0)&&e.jsx("div",{className:"rounded-2xl px-1.5 py-0.5 flex items-center justify-center text-white bg-primary text-xs",children:t.tags.length+t.sets.length})]}),e.jsxs(ge,{anchor:"bottom end",className:"flex flex-col w-[400px] bg-white drop-shadow-lg p-6 rounded-md mt-4",children:[e.jsx("p",{className:"text-md font-semibold mb-4",children:"Filters"}),e.jsx("div",{className:"flex flex-row justify-between w-full pb-2",children:s.annotationSets.length>1&&e.jsxs("div",{className:"w-full pb-2",children:[e.jsxs("div",{className:"flex flex-row justify-between w-full pb-2",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Annotation Sets"}),t.sets.length>0&&e.jsxs("div",{className:"bg-primary rounded-lg flex items-center justify-center gap-2 py-1 px-2 text-white cursor-default text-xs font-semibold",children:[e.jsx("p",{children:`${t.sets.length} filter${t.sets.length>1?"s":""} applied`}),e.jsx(T,{className:"size-4 text-white hover:scale-105 cursor-pointer",onClick:()=>S("sets",r)})]})]}),s.annotationSets.map(a=>e.jsx("div",{className:"block",children:e.jsxs("div",{className:"flex flex-row gap-3 py-1",children:[e.jsx(P,{checked:t.sets&&t.sets.includes(a.id),onChange:()=>{X(a.id,r)},className:"group size-4 bg-white rounded-sm data-[checked]:bg-primary p-0.5 ring-1 ring-gray-300 ring-inset data-[checked]:ring-primary",children:e.jsx(v,{className:"hidden size-3 group-data-[checked]:block text-white"})}),e.jsx("p",{className:"capitalize font-semibold text-xs",children:a.data.set.replaceAll("_","")})]})},a.id))]})}),e.jsxs("div",{className:"flex flex-row justify-between w-full pb-2",children:[e.jsx("p",{className:"text-sm  font-semibold",children:"Tags"}),t.tags.length>0&&e.jsxs("div",{className:"bg-primary rounded-lg flex items-center justify-center gap-2 py-1 px-2 text-white cursor-default text-xs font-semibold",children:[e.jsx("p",{children:`${t.tags.length} filter${t.tags.length>1?"s":""} applied`}),e.jsx(T,{className:"size-4 text-white hover:scale-105 cursor-pointer",onClick:()=>S("tags",r)})]})]}),t&&o.map((a,x)=>e.jsxs(w.Fragment,{children:[x>0?e.jsx("div",{className:"h-[1px] bg-gray-200 w-full my-3"}):null,e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-row gap-3 py-1",children:[e.jsx(P,{checked:t.tags&&t.tags.filter(n=>n.category.toLowerCase()===a.toLowerCase()).length===m[a].tags.length,onChange:()=>{q(a,m,r)},className:"group size-4 bg-white rounded-sm data-[checked]:bg-primary p-0.5 ring-1 ring-gray-300 ring-inset data-[checked]:ring-primary",children:e.jsx(v,{className:"hidden size-3 group-data-[checked]:block text-white"})}),e.jsx("p",{className:"capitalize font-semibold text-xs",children:a.replaceAll("_","")})]}),e.jsx("div",{className:"flex flex-row gap-2 flex-wrap",children:m[a].tags.map((n,g)=>e.jsx(ke,{color:m[a].color,tag:n,icon:t.tags&&t.tags?.findIndex(i=>i.category==a&&i.tag==n)!==-1?v:void 0,className:t.tags&&t.tags?.findIndex(i=>i.category===a&&i.tag===n)!==-1?"outline outline-1 outline-black":"",onClick:()=>{J({category:a,tag:n},r)}},g))})]},x)]},x))]})]})};export{Pe as default};
